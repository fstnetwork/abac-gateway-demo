<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
      crossorigin="anonymous"
    />

    <link
      href="https://fonts.googleapis.com/css?family=Source+Sans+Pro&display=swap"
      rel="stylesheet"
    />

    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />

    <title>ABAC Gateway Demo</title>
    <style>
      body {
        font-family: "Source Sans Pro", sans-serif;
      }
    </style>
  </head>

  <body>
    <div>
      <div class="p-5">
        <div class="container">
          <div class="row">
            <div class="col-8">
              <h2 style="color: rgb(128, 122, 122)">ABAC Gateway Demo</h2>
              <p style="color: rgb(128, 122, 122)">
                Attribute-based Access Control using attributes defined by the
                gateway admin
              </p>
            </div>
            <div class="col-4">
              <button
                id="logout"
                type="button"
                class="btn btn-outline-danger float-right"
                data-toggle="modal"
                data-target="#logoutModal"
              >
                Logout
              </button>
              <button
                id="login"
                type="button"
                class="btn btn-outline-info float-right"
                data-toggle="modal"
                data-target="#exampleModal"
              >
                Login
              </button>
            </div>
          </div>
        </div>

        <div class="container">
          <div class="row align-items-center">
            <div
              class="col-6"
              style="padding-top: .75em; padding-bottom: .75em;"
            >
              <h3><span id="username">Admin</span>'s Attribute List</h3>
            </div>
            <div
              class="col-6"
              style="padding-top: .75em; padding-bottom: .75em;"
            >
              <button
                class="btn btn-primary float-right"
                data-toggle="modal"
                data-target="#addAttributeModal"
                onclick="openAddAttribute()"
              >
                Add Attribute
              </button>
            </div>
          </div>
          <div class="row pt-3">
            <div class="col-12">
              <table
                id="attributeList"
                class="table table-striped attribute-list"
              >
                <thead>
                  <tr>
                    <th scope="col">#</th>
                    <th scope="col">Address</th>
                    <th scope="col">Name</th>
                    <th scope="col">Symbol</th>
                    <th scope="col">Total Supply</th>
                    <th scope="col">Transfer</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>

        <br />
        <br />

        <div class="container">
          <div class="row">
            <div class="col-12">
              <h2 style="color: rgb(128, 122, 122)">
                Resource Endpoints ABAC Rules
              </h2>
              <p style="color: rgb(128, 122, 122)">
                Admin defines which attributes combination is required to access
                to each resource
              </p>
            </div>
          </div>
        </div>
      </div>

      <div class="container">
        <div class="row">
          <div class="col-12">
            <button
              type="button"
              class="btn btn-outline-primary"
              id="previewBtn"
            >
              Preview Clients Accessibility
            </button>
          </div>
        </div>
      </div>

      <!-- Preview User Rule Modal -->
      <div
        class="modal fade"
        id="previewUserRuleModal"
        tabindex="-1"
        role="dialog"
        aria-labelledby="previewUserRule"
        aria-hidden="true"
      >
        <div
          class="modal-dialog modal-lg modal-dialog-centered "
          role="document"
        >
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="previewUserRuleTitle">
                Preview Clients Accessibility
              </h5>
            </div>
            <div class="modal-body" id="previewUserRuleBody">
              <!-- <label for="previewUserRuleSelect">End-User</label>
              <select class="form-control" id="previewUserRuleSelect"> </select> -->
              <pre id="previewUserPre"></pre>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                id="previewUserClose"
              >
                Close
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="container p-3">
        <div class="row">
          <div class="col-3">
            <div class="row">
              <div class="col-12">
                <h5>GET /resource/a00000</h5>
              </div>
            </div>
            <div class="row">
              <div class="col-12">
                <p>Current Rules</p>
              </div>
            </div>
          </div>
          <div class="col">
            <div class="card shadow-sm">
              <div class="card-body">
                <div id="resourcea0000"></div>
                <!-- rule part end -->
                <div class="row pt-2">
                  <div class="col text-right">
                    <a
                      href="#"
                      class="shadow-sm btn btn-info"
                      onclick="editRule('/resource/a0000')"
                      >Edit</a
                    >
                  </div>
                </div>
              </div>
              <!-- card body end -->
            </div>
          </div>
        </div>
      </div>

      <div class="container p-3">
        <div class="row">
          <div class="col-3">
            <div class="row">
              <div class="col-12">
                <h5>GET /resource/b00000</h5>
              </div>
            </div>
            <div class="row">
              <div class="col-12">
                <p>Current Rules</p>
              </div>
            </div>
          </div>
          <div class="col">
            <div class="card shadow-sm">
              <div class="card-body">
                <div id="resourceb0000"></div>
                <!-- rule part end -->
                <div class="row pt-2">
                  <div class="col text-right">
                    <a
                      href="#"
                      class="shadow-sm btn btn-info"
                      onclick="editRule('/resource/b0000')"
                      >Edit</a
                    >
                  </div>
                </div>
              </div>
              <!-- card body end -->
            </div>
          </div>
        </div>
      </div>

      <div class="container p-3">
        <div class="row">
          <div class="col-3">
            <div class="row">
              <div class="col-12">
                <h5>GET /resource/c00000</h5>
              </div>
            </div>
            <div class="row">
              <div class="col-12">
                <p>Current Rules</p>
              </div>
            </div>
          </div>
          <div class="col">
            <div class="card shadow-sm">
              <div class="card-body">
                <div id="resourcec0000"></div>

                <!-- rule part end -->
                <div class="row pt-2">
                  <div class="col text-right">
                    <a
                      href="#"
                      class="shadow-sm btn btn-info"
                      onclick="editRule('/resource/c0000')"
                      >Edit</a
                    >
                  </div>
                </div>
              </div>
              <!-- card body end -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <footer class="text-muted" style="background-color: #f7f7f7;">
      <div class="container-fluid p-3">
        <p>Powered by FST NETWORK</p>
      </div>
    </footer>

    <!-- Logout Modal -->
    <div
      class="modal fade"
      id="logoutModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="logoutModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-body">
            <label for="logoutInputEmail1">Logout?</label>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              id="logoutClose"
              data-dismiss="modal"
            >
              No
            </button>
            <button
              type="button"
              class="btn btn-danger"
              id="logoutRequest"
              onclick="adminlogout()"
            >
              Yes
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Login Modal -->
    <div
      class="modal fade"
      id="exampleModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-body">
            <form>
              <div class="form-group">
                <label for="exampleInputEmail1">Id</label>
                <input
                  type="email"
                  class="form-control"
                  id="exampleInputId"
                  aria-describedby="emailHelp"
                  placeholder="Please input admin ID"
                />
              </div>
              <div class="form-group">
                <label for="exampleInputPassword">Password</label>
                <input
                  type="password"
                  class="form-control"
                  id="exampleInputPassword"
                  placeholder="Password"
                />
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-dismiss="modal"
            >
              Close
            </button>
            <button
              type="button"
              class="btn btn-primary"
              id="loginRequest"
              onclick="loginAdmin()"
            >
              Submit
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- add attrubute modal -->
    <div
      class="modal fade"
      id="addAttributeModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="addAttributeModal"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Add Attribute</h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <label for="vouchername">Name</label>
              <input
                type="text"
                class="form-control"
                id="vouchername"
                aria-describedby="emailHelp"
              />
            </div>

            <div class="form-group">
              <label for="vouchersymbol">Symbol</label>
              <input type="text" class="form-control" id="vouchersymbol" />
            </div>

            <div id="afterAttributePublish" style="display: none;">
              <div class="row pt-3">
                <div class="col-6 text-center">
                  <h5>
                    Attribute creation completed
                  </h5>
                </div>
                <div class="col-6">
                  <a
                    class="btn btn-info btn-sm btn-block class-center"
                    target="_blank"
                  >
                    Verify on the explorer
                    <!-- <i class="material-icons">
                      trending_flat
                    </i> -->
                  </a>
                </div>
              </div>
            </div>
          </div>

          <div class="modal-footer">
            <button
              type="button"
              id="attributeCancelButton"
              class="btn btn-secondary"
              data-dismiss="modal"
              aria-label="Close"
            >
              Close
            </button>
            <button
              type="button"
              id="attributeSubmitButton"
              class="btn btn-primary"
              onclick="publishFungibleVoucher()"
            >
              Submit
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- transfer modal -->
    <div
      class="modal fade"
      id="transferAttribute"
      tabindex="-1"
      role="dialog"
      aria-labelledby="transferAttribute"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg modal-dialog-centered " role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="transferAttributeTitle">
              Transfer Attribute
            </h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <label for="transferValue">Value</label>
              <input
                type="number"
                min="0"
                value="0"
                class="form-control"
                id="transferValue"
                aria-describedby="emailHelp"
              />
            </div>

            <div class="form-group">
              <label for="transferTargetAddress">End-User</label>
              <select class="form-control" id="transferTargetAddress"> </select>
            </div>

            <div id="afterTransferResultShow" style="display: none;">
              <div class="row pt-3">
                <div class="col-6 text-center">
                  <h5>
                    Attribute transfer completed
                  </h5>
                </div>
                <div class="col-6">
                  <a
                    class="btn btn-info btn-sm btn-block class-center"
                    target="_blank"
                  >
                    Verify on the explorer
                    <!-- <i class="material-icons">
                      trending_flat
                    </i> -->
                  </a>
                </div>
              </div>
            </div>
          </div>

          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-dismiss="modal"
              id="transferAttributeCancelButton"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-primary"
              onclick="transferAttribute()"
              id="transferAttributeSubmitButton"
            >
              Submit
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- edit rule modal -->
    <div
      class="modal fade"
      id="ruleEditModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="ruleEditModal"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-xl modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="ruleEditModalTitle"></h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>

          <div class="modal-body">
            <div class="row pb-2">
              <div class="col">
                <h4>
                  Clients who hold
                </h4>
              </div>
              <div class="col text-right">
                <button class="btn btn-outline-info" onclick="addRule()">
                  Add Rule
                </button>
              </div>
            </div>

            <div id="ruleEditModalBody"></div>

            <div class="row pt-3">
              <div class="col">
                <h6 style="color: rgb(128, 122, 122)">Can access to the resource endpoint</h6>
              </div>
            </div>

            <!-- <div class="row">
            <div class="col-12">
              <div class="input-group mb-3">

                <select class="custom-select" id="target01">
                  <option value="1">Attribute 01 (ATR01)</option>
                  <option value="2">Attribute 01 (ATR01)</option>
                  <option value="3">Attribute 01 (ATR01)</option>
                  <option value="4">Attribute 01 (ATR01)</option>
                  <option value="5">Attribute 01 (ATR01)</option>
                  <option value="6">Attribute 01 (ATR01)</option>
                  <option value="7">Attribute 01 (ATR01)</option>

                </select>

                <div class="input-group-append">
                  <label class="input-group-text" for="target01">target</label>
                </div>

                <select class="custom-select" id="inputGroupSelect02">
                  <option value="1">LESS THAN ( &lt; )</option>
                  <option value="2">MORE THAN ( &gt;)</option>
                  <option value="3">EQUAL TO ( = )</option>
                </select>
                <div class="input-group-append">
                  <label class="input-group-text" for="inputGroupSelect02">operator</label>
                </div>

                <input type="text" class="form-control" aria-label="Text input with dropdown button" id="targetValue"
                  placeholder="amount" style="max-width: 120px;">

                <div class="input-group-append">
                  <span class="input-group-text" for="targetValue">ATR01</span>
                </div>

              </div>
            </div>
          </div> -->
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-danger" data-dismiss="modal">
              Cancel
            </button>
            <button type="button" class="btn btn-primary" onclick="saveRule()">
              Save
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- edit rule modal end -->

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script
      src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
      integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
      integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
      integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
      crossorigin="anonymous"
    ></script>

    <script
      charset="utf-8"
      src="https://cdn.ethers.io/scripts/ethers-v4.min.js"
      type="text/javascript"
    ></script>
    <script src="./js/util.js"></script>
    <script src="./js/adminlogin.js"></script>
    <script src="./js/previewClient.js"></script>
  </body>
</html>
